unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Mask, DBCtrls, StdCtrls, Grids, DBGrids, ExtCtrls, ComCtrls,
  Menus, Buttons;

type
  TfrmPrincipal = class(TForm)
    PageControl1: TPageControl;
    TabSheet1: TTabSheet;
    DBNavigator1: TDBNavigator;
    Button1: TButton;
    Panel1: TPanel;
    DBGrid1: TDBGrid;
    TabSheet2: TTabSheet;
    DBNavigator2: TDBNavigator;
    Button2: TButton;
    TabSheet3: TTabSheet;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Label9: TLabel;
    Label10: TLabel;
    Label11: TLabel;
    Label12: TLabel;
    Label13: TLabel;
    Label14: TLabel;
    Label15: TLabel;
    Label16: TLabel;
    Label17: TLabel;
    DBEdit1: TDBEdit;
    DBEdit2: TDBEdit;
    DBEdit3: TDBEdit;
    DBEdit4: TDBEdit;
    DBEdit5: TDBEdit;
    DBEdit6: TDBEdit;
    DBEdit7: TDBEdit;
    DBEdit8: TDBEdit;
    DBEdit9: TDBEdit;
    DBEdit10: TDBEdit;
    DBEdit11: TDBEdit;
    DBEdit12: TDBEdit;
    DBEdit13: TDBEdit;
    DBEdit14: TDBEdit;
    DBEdit15: TDBEdit;
    DBEdit16: TDBEdit;
    DBEdit17: TDBEdit;
    DBNavigator3: TDBNavigator;
    Button3: TButton;
    TabSheet4: TTabSheet;
    Label18: TLabel;
    Label19: TLabel;
    Label20: TLabel;
    Label21: TLabel;
    Label22: TLabel;
    Label23: TLabel;
    Label24: TLabel;
    Label25: TLabel;
    Label26: TLabel;
    Label27: TLabel;
    Label28: TLabel;
    Label29: TLabel;
    Label30: TLabel;
    Label31: TLabel;
    Label32: TLabel;
    Label33: TLabel;
    DBEdit18: TDBEdit;
    DBEdit19: TDBEdit;
    DBEdit20: TDBEdit;
    DBEdit21: TDBEdit;
    DBEdit22: TDBEdit;
    DBEdit23: TDBEdit;
    DBEdit24: TDBEdit;
    DBEdit25: TDBEdit;
    DBEdit26: TDBEdit;
    DBEdit27: TDBEdit;
    DBEdit28: TDBEdit;
    DBEdit29: TDBEdit;
    DBEdit30: TDBEdit;
    DBEdit31: TDBEdit;
    DBEdit32: TDBEdit;
    DBEdit33: TDBEdit;
    DBNavigator4: TDBNavigator;
    Button4: TButton;
    LabeledEdit1: TLabeledEdit;
    LabeledEdit2: TLabeledEdit;
    LabeledEdit3: TLabeledEdit;
    LabeledEdit4: TLabeledEdit;
    LabeledEdit5: TLabeledEdit;
    LabeledEdit6: TLabeledEdit;
    LabeledEdit7: TLabeledEdit;
    LabeledEdit8: TLabeledEdit;
    BitBtn2: TBitBtn;
    BitBtn3: TBitBtn;
    BitBtn4: TBitBtn;
    BitBtn5: TBitBtn;
    TabSheet6: TTabSheet;
    GroupBox1: TGroupBox;
    Label37: TLabel;
    GroupBox2: TGroupBox;
    Label38: TLabel;
    Label39: TLabel;
    Label40: TLabel;
    DBEdit38: TDBEdit;
    DBEdit39: TDBEdit;
    DBGrid2: TDBGrid;
    DBGrid4: TDBGrid;
    DBEdit34: TDBEdit;
    DBEdit35: TDBEdit;
    DBText1: TDBText;
    GroupBox4: TGroupBox;
    DBEdit36: TDBEdit;
    DBEdit42: TDBEdit;
    DBEdit43: TDBEdit;
    Label34: TLabel;
    Label35: TLabel;
    Label36: TLabel;
    Label41: TLabel;
    Label42: TLabel;
    Label43: TLabel;
    DBGrid5: TDBGrid;
    Edit1: TEdit;
    Button5: TButton;
    DBEdit40: TDBEdit;
    DBEdit41: TDBEdit;
    DBEdit44: TDBEdit;
    DBEdit45: TDBEdit;
    DBEdit46: TDBEdit;
    DBEdit37: TDBEdit;
    TabSheet7: TTabSheet;
    DBGrid6: TDBGrid;
    Button6: TButton;
    Button7: TButton;
    Button8: TButton;
    DBEdit47: TDBEdit;
    DBEdit48: TDBEdit;
    Label45: TLabel;
    DBNavigator6: TDBNavigator;
    TabSheet8: TTabSheet;
    GroupBox3: TGroupBox;
    Label46: TLabel;
    Label47: TLabel;
    Label48: TLabel;
    Label49: TLabel;
    DBEdit50: TDBEdit;
    DBEdit51: TDBEdit;
    DBEdit52: TDBEdit;
    GroupBox5: TGroupBox;
    Label50: TLabel;
    Label51: TLabel;
    Label52: TLabel;
    Label53: TLabel;
    DBEdit54: TDBEdit;
    DBEdit55: TDBEdit;
    DBEdit56: TDBEdit;
    GroupBox6: TGroupBox;
    Label54: TLabel;
    Label55: TLabel;
    Label56: TLabel;
    Label57: TLabel;
    DBEdit58: TDBEdit;
    DBEdit59: TDBEdit;
    DBEdit60: TDBEdit;
    GroupBox7: TGroupBox;
    Label58: TLabel;
    Label59: TLabel;
    Label60: TLabel;
    Label61: TLabel;
    DBEdit62: TDBEdit;
    DBEdit63: TDBEdit;
    DBEdit64: TDBEdit;
    DBText2: TDBText;
    Label62: TLabel;
    Button9: TButton;
    DBEdit65: TDBEdit;
    DBEdit66: TDBEdit;
    DBEdit67: TDBEdit;
    Edit3: TEdit;
    Edit2: TEdit;
    Label44: TLabel;
    Button10: TButton;
    Button11: TButton;
    Label63: TLabel;
    DBEdit75: TDBEdit;
    DBEdit76: TDBEdit;
    Label64: TLabel;
    Edit4: TEdit;
    Edit5: TEdit;
    Edit6: TEdit;
    MainMenu1: TMainMenu;
    Sistema1: TMenuItem;
    Fechar1: TMenuItem;
    GroupBox8: TGroupBox;
    DBGrid3: TDBGrid;
    DBEdit49: TDBEdit;
    DBEdit53: TDBEdit;
    DBEdit57: TDBEdit;
    DBEdit61: TDBEdit;
    DBEdit69: TDBEdit;
    DBEdit70: TDBEdit;
    DBEdit71: TDBEdit;
    DBEdit68: TDBEdit;
    LabeledEdit9: TLabeledEdit;
    LabeledEdit10: TLabeledEdit;
    DBEdit72: TDBEdit;
    Label65: TLabel;
    LabeledEdit11: TLabeledEdit;
    Button12: TButton;
    procedure Fechar1Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure BitBtn2Click(Sender: TObject);
    procedure BitBtn3Click(Sender: TObject);
    procedure BitBtn1Click(Sender: TObject);
    procedure DBEdit35Exit(Sender: TObject);
    procedure Edit1Exit(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure Button6Click(Sender: TObject);
    procedure DBEdit36Exit(Sender: TObject);
    procedure Button7Click(Sender: TObject);
    procedure DBEdit39Exit(Sender: TObject);
    procedure Button11Click(Sender: TObject);
    procedure DBEdit35Change(Sender: TObject);
    procedure DBEdit37Change(Sender: TObject);
    procedure Edit3Change(Sender: TObject);
    procedure Button9Click(Sender: TObject);
    procedure Button10Click(Sender: TObject);
    procedure DBEdit57Change(Sender: TObject);
    procedure Edit4Exit(Sender: TObject);
    procedure Edit5Exit(Sender: TObject);
    procedure Edit6Exit(Sender: TObject);
    procedure DBEdit51Exit(Sender: TObject);
    procedure DBEdit53Enter(Sender: TObject);
    procedure DBEdit49Click(Sender: TObject);
    procedure Edit4Click(Sender: TObject);
    procedure Edit5Click(Sender: TObject);
    procedure Edit6Click(Sender: TObject);
    procedure DBEdit75Exit(Sender: TObject);
    procedure DBEdit76Change(Sender: TObject);
    procedure DBEdit76Exit(Sender: TObject);
    procedure Button12Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmPrincipal: TfrmPrincipal;

implementation

uses Udm, DBClient, DB, UfrmProduto, UfrmMateria, UfrmCliente,
  UfrmFornecedor, UfrmComponente, MaskUtils,UfrmFiltroCustoComponente,
  UFiltroCustoProduto, USplash;

{$R *.dfm}

procedure TfrmPrincipal.Fechar1Click(Sender: TObject);
begin
  Application.Terminate;
end;

procedure TfrmPrincipal.Button1Click(Sender: TObject);
begin
  with dm.cdsProduto do
  begin
    close;
     Params.ParamByName('Cod1').AsString:=LabeledEdit1.Text;
     Params.ParamByName('Cod2').AsString:=LabeledEdit2.Text;
     Open;
     try
     begin
      frmProduto:=TfrmProduto.Create(Self);
      frmProduto.ShowModal;
      end;
     finally
      FreeAndNil(frmProduto);
      end;

   end;
end;

procedure TfrmPrincipal.Button2Click(Sender: TObject);
begin
 with dm.cdsMateria do
  begin
    close;
     Params.ParamByName('Cod3').AsString:=LabeledEdit3.Text;
     Params.ParamByName('Cod4').AsString:=LabeledEdit4.Text;
     Open;
     try
     begin
      frmMateria:=TfrmMateria.Create(Self);
      frmMateria.ShowModal;
     end;
     finally
      FreeAndNil(frmMateria);
      end;

   end;
end;

procedure TfrmPrincipal.Button3Click(Sender: TObject);
begin
with dm.cdsCliente do
  begin
    close;
     Params.ParamByName('CN1').AsString:=LabeledEdit7.Text;
     Params.ParamByName('CN2').AsString:=LabeledEdit8.Text;
     Open;
     try
     begin
      frmCliente:=TfrmCliente.Create(Self);
      frmCliente.ShowModal;
     end;
     finally
      FreeAndNil(frmCliente);
      end;

   end;
end;

procedure TfrmPrincipal.Button4Click(Sender: TObject);
begin
with dm.cdsFornecedor do
  begin
    close;
     Params.ParamByName('CN3').AsString:=LabeledEdit5.Text;
     Params.ParamByName('CN4').AsString:=LabeledEdit6.Text;
     Open;
     try
     begin
      frmForncedor:=TfrmForncedor.Create(Self);
      frmForncedor.ShowModal;
     end;
     finally
      FreeAndNil(frmForncedor);
      end;
    end;
end;



procedure TfrmPrincipal.BitBtn2Click(Sender: TObject);
begin
 dm.RvpProduto.Execute;
end;

procedure TfrmPrincipal.BitBtn3Click(Sender: TObject);
begin
  dm.RvpMat.Execute;
end;

procedure TfrmPrincipal.BitBtn1Click(Sender: TObject);
begin
  dm.RvComp.Execute;
end;



procedure TfrmPrincipal.DBEdit35Exit(Sender: TObject);
begin
   DBEdit41.Text:=Edit1.Text;
   DBEdit44.Text:=DBEdit42.Text;
   DBEdit45.Text:=DBEdit43.Text;
   DBEdit46.Text:=DBEdit34.Text;
   DBEdit40.Text:=DBEdit37.Text;
   if (DBEdit35.Text='') and (DBEdit36.Text='') then
   begin
    ShowMessage('O Campo da Quantidade deve ser Preenchido!...Por Favor Verifique');
    DBEdit36.TabStop:=false;
    end
    else
    begin
    DBEdit35.TabStop:=true;
    DBEdit36.TabStop:=true;
    DBGrid5.Refresh;
    end;
end;

procedure TfrmPrincipal.Edit1Exit(Sender: TObject);
begin
   with dm.cdsFiltro do
   begin
   Close;
     Params.ParamByName('COD85').AsString:=Edit1.Text;
   Open;
   end;
   dm.cdsRelCust.Insert;
end;

procedure TfrmPrincipal.Button5Click(Sender: TObject);
begin
  dm.cdsFichaCusto.ApplyUpdates(0);
  dm.cdsRelCust.ApplyUpdates(0);
  DBGrid5.Refresh;
end;

procedure TfrmPrincipal.Button6Click(Sender: TObject);
begin
  dm.cdsMaoObra.Insert;
  dm.cdsMaoObra.ApplyUpdates(0);
end;

procedure TfrmPrincipal.DBEdit36Exit(Sender: TObject);
var
  i:single;
  j:single;
  s:single;
begin
  i:=StrToFloat(DBEdit34.Text);
  j:=StrToFloat(DBEdit35.Text);
  s:=i*j;
  DBEdit36.Text:=FloatToStr(s);
  FormatMaskText('00,0000',DBEdit35.Text);
  FormatMaskText('R$0,0000',DBEdit36.Text);
  FormatMaskText('R$0,0000',DBText1.Caption);
end;

procedure TfrmPrincipal.Button7Click(Sender: TObject);
begin
  dm.cdsFiltroCusto.Delete;
  dm.cdsFiltroCusto.ApplyUpdates(0);
  dm.cdsFiltroCusto.Refresh;
  DBGrid5.Refresh;
end;

procedure TfrmPrincipal.DBEdit39Exit(Sender: TObject);
begin
  dm.cdsFichaCusto.ApplyUpdates(0);
end;



procedure TfrmPrincipal.Button11Click(Sender: TObject);
begin
  dm.cdsRelProdCust.Delete;
  dm.cdsRelProdCust.ApplyUpdates(0);
  DBGrid3.Refresh;
end;

procedure TfrmPrincipal.DBEdit35Change(Sender: TObject);
begin
if (DBEdit35.Text<>'') then
  DBEdit36.TabStop:=true
  else
  DBEdit36.TabStop:=false;
end;

procedure TfrmPrincipal.DBEdit37Change(Sender: TObject);
begin
    DBEdit38.Text:=DBEdit65.Text;
    DBEdit39.Text:=DBEdit66.Text;
    DBEdit48.Text:=DBEdit67.Text;
end;

procedure TfrmPrincipal.Edit3Change(Sender: TObject);
begin
  with dm.cdsFiltroComp1 do
  begin
    Close;
     Params.ParamByName('Cod21').AsString:=Edit3.Text;
    Open;
    end;
end;

procedure TfrmPrincipal.Button9Click(Sender: TObject);
begin
with dm.cdsFiltroCusto do
  begin
  Close;
    Params.ParamByName('Cod41').AsString:=Edit2.Text;
  Open;
    end;
  try
   frmFiltroCustoComp:=TfrmFiltroCustoComp.Create(Self);
   frmFiltroCustoComp.ShowModal;
   finally
    FreeAndNil(frmFiltroCustoComp);
end;
end;

procedure TfrmPrincipal.Button10Click(Sender: TObject);
begin
  dm.cdsProdCust.ApplyUpdates(0);
  dm.cdsRelProdCust.ApplyUpdates(0);
  DBGrid3.Refresh;
end;

procedure TfrmPrincipal.DBEdit57Change(Sender: TObject);
begin
  dm.cdsRelProdCust.Insert;
end;

procedure TfrmPrincipal.Edit4Exit(Sender: TObject);
begin
  with dm.cdsFiltroMat1 do
  begin
  close;
    Params.ParamByName('Cod33').AsString:=Edit4.Text;
  Open;
  end;
  begin
   DBEdit53.Text:=DBEdit49.Text;
   DBEdit57.Text:=DBEdit50.Text;
   DBEdit61.Text:=DBEdit51.Text;
   DBEdit69.Text:=Edit4.Text;
   DBEdit68.Text:=DBEdit56.Text;
   DBEdit72.Text:=DBEdit56.Text;
  end;
end;

procedure TfrmPrincipal.Edit5Exit(Sender: TObject);
begin
  with dm.cdsFiltroObra do
  begin
  close;
    Params.ParamByName('Cod74').AsString:=Edit5.Text;
  Open;
  end;
   begin
    DBEdit53.Text:=DBEdit49.Text;
    DBEdit57.Text:=DBEdit50.Text;
    DBEdit61.Text:=DBEdit51.Text;
    DBEdit70.Text:=Edit5.Text;
    DBEdit68.Text:=DBEdit60.Text;
    DBEdit72.Text:=DBEdit60.Text;
   end;
end;

procedure TfrmPrincipal.Edit6Exit(Sender: TObject);
begin
  with dm.cdsFiltroComp2 do
  begin
  close;
    Params.ParamByName('Cod17').AsString:=Edit6.Text;
  Open;
  end;
  begin
    DBEdit53.Text:=DBEdit49.Text;
    DBEdit57.Text:=DBEdit50.Text;
    DBEdit61.Text:=DBEdit51.Text;
    DBEdit71.Text:=Edit6.Text;
    DBEdit68.Text:=DBEdit64.Text;
    DBEdit72.Text:=DBEdit64.Text;
  end;
end;

procedure TfrmPrincipal.DBEdit51Exit(Sender: TObject);
begin
  {dm.cdsProdCust.ApplyUpdates(0);}

end;

procedure TfrmPrincipal.DBEdit53Enter(Sender: TObject);
begin
  DBEdit53.Text:=DBEdit49.Text;
end;

procedure TfrmPrincipal.DBEdit49Click(Sender: TObject);
begin
    dm.cdsProdCust.Insert;
end;

procedure TfrmPrincipal.Edit4Click(Sender: TObject);
begin
     dm.cdsRelProdCust.Insert;
end;

procedure TfrmPrincipal.Edit5Click(Sender: TObject);
begin
  dm.cdsRelProdCust.Insert;
end;

procedure TfrmPrincipal.Edit6Click(Sender: TObject);
begin
  dm.cdsRelProdCust.Insert;
end;

procedure TfrmPrincipal.DBEdit75Exit(Sender: TObject);
var
  i,j,s:single;
begin
  i:=StrToFloat(DBEdit72.Text);
  j:=StrToFloat(DBEdit76.Text);
  s:=i*j;
  DBEdit75.Text:=FloatToStr(s);
end;

procedure TfrmPrincipal.DBEdit76Change(Sender: TObject);
begin
  if (DBEdit76.Text<>'') then
  DBEdit75.TabStop:=true
  else
  DBEdit75.TabStop:=false;
end;

procedure TfrmPrincipal.DBEdit76Exit(Sender: TObject);
begin
 if (DBEdit76.Text='') and (DBEdit75.Text='') then
   begin
    ShowMessage('O Campo da Quantidade deve ser Preenchido!...Por Favor Verifique');
    DBEdit75.TabStop:=false;
    end
    else
    begin
    DBEdit76.TabStop:=true;
    DBEdit75.TabStop:=true;
    DBGrid3.Refresh;
    end;
end;

procedure TfrmPrincipal.Button12Click(Sender: TObject);
begin
  with dm.cdsFiltroCustProd do
  begin
    Close;
      Params.ParamByName('Cod85').AsString:=LabeledEdit11.Text;
    Open;
    end;       
try
  begin
    frmRelatorioCustoProduto:=TfrmRelatorioCustoProduto.Create(Self);
    frmRelatorioCustoProduto.ShowModal;
  end;
  finally
    FreeAndNil(frmRelatorioCustoProduto);
  end;
end;

end.



